
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/SIB_logo.svg">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Group work - Long reads and RNA</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#roles-organisation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Long reads and RNA" class="md-header-nav__button md-logo" aria-label="Long reads and RNA">
      
  <img src="../../assets/images/SIB_logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Long reads and RNA
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Group work
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/GeertvanGeest/course_website_template" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GeertvanGeest/course_website_template
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Long reads and RNA" class="md-nav__button md-logo" aria-label="Long reads and RNA">
      
  <img src="../../assets/images/SIB_logo.svg" alt="logo">

    </a>
    Long reads and RNA
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/GeertvanGeest/course_website_template" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GeertvanGeest/course_website_template
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../precourse/" class="md-nav__link">
      Precourse preparations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../course_schedule/" class="md-nav__link">
      Course schedule
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Course material
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Course material" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Course material
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../introduction/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../server_login/" class="md-nav__link">
      Server login
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../qc_alignment/" class="md-nav__link">
      QC and alignment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../downstream_analyses/" class="md-nav__link">
      Downstream analyses
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Group work
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Group work
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#roles-organisation" class="md-nav__link">
    Roles &amp; organisation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-1-differential-isoform-expression-analysis-of-ont-data" class="md-nav__link">
     Project 1: Differential isoform expression analysis of ONT data
  </a>
  
    <nav class="md-nav" aria-label=" Project 1: Differential isoform expression analysis of ONT data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#before-you-start" class="md-nav__link">
    Before you start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tasks-questions" class="md-nav__link">
    Tasks &amp; questions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-2-repeat-expansion-analysis-of-pacbio-data" class="md-nav__link">
     Project 2: Repeat expansion analysis of PacBio data
  </a>
  
    <nav class="md-nav" aria-label=" Project 2: Repeat expansion analysis of PacBio data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#before-you-start_1" class="md-nav__link">
    Before you start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tasks-questions_1" class="md-nav__link">
    Tasks &amp; questions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#roles-organisation" class="md-nav__link">
    Roles &amp; organisation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-1-differential-isoform-expression-analysis-of-ont-data" class="md-nav__link">
     Project 1: Differential isoform expression analysis of ONT data
  </a>
  
    <nav class="md-nav" aria-label=" Project 1: Differential isoform expression analysis of ONT data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#before-you-start" class="md-nav__link">
    Before you start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tasks-questions" class="md-nav__link">
    Tasks &amp; questions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-2-repeat-expansion-analysis-of-pacbio-data" class="md-nav__link">
     Project 2: Repeat expansion analysis of PacBio data
  </a>
  
    <nav class="md-nav" aria-label=" Project 2: Repeat expansion analysis of PacBio data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#before-you-start_1" class="md-nav__link">
    Before you start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tasks-questions_1" class="md-nav__link">
    Tasks &amp; questions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Group work</h1>
                
                <p>The last part of this course will consist of project-based-learning. This means that you will work in groups on a single question. We will split up into groups of five people.</p>
<div class="admonition note">
<p class="admonition-title">If working independently</p>
<p>If you are working independently, you probably can not work in a group. However, you can test your skills with these real biological datasets. Realize that the datasets and calculations are (much) bigger compared to the exercises, so check if your computer is up for it. You&rsquo;ll probably need around 4 cores, 16G of RAM and 10G of harddisk.</p>
</div>
<div class="admonition note">
<p class="admonition-title">If online</p>
<p>If the course takes place online, we will use break-out rooms to communicate within groups. Please stay in the break-out room during the day, also if you are working individually.</p>
</div>
<h2 id="roles-organisation">Roles &amp; organisation</h2>
<p>Project based learning is about learning by doing, but also about <em>peer instruction</em>. This means that you will be both a learner and a teacher. There will be differences in levels among participants, but because of that, some will learn efficiently from people that have just learned, and others will teach and increase their understanding.</p>
<p>Each project has <strong>tasks</strong> and <strong>questions</strong>. By performing the tasks, you should be able to answer the questions. At the start of the project, make sure that each of you gets a task assigned. You should consider the tasks and questions as a guidance. If interesting questions pop up during the project, you are <strong>encouraged</strong> to work on those. Also, you don&rsquo;t have to perform all the tasks and answer all the questions.</p>
<p>In the afternoon of day 1, you will divide the initial tasks, and start on the project. On day 2, you can work on the project in the morning and in the first part of the afternoon. We will conclude the projects with a <strong>10-minute presentation</strong> of each group.</p>
<h2 id="project-1-differential-isoform-expression-analysis-of-ont-data"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M208 0c-29.9 0-54.7 20.5-61.8 48.2-.8 0-1.4-.2-2.2-.2-35.3 0-64 28.7-64 64 0 4.8.6 9.5 1.7 14C52.5 138 32 166.6 32 200c0 12.6 3.2 24.3 8.3 34.9C16.3 248.7 0 274.3 0 304c0 33.3 20.4 61.9 49.4 73.9-.9 4.6-1.4 9.3-1.4 14.1 0 39.8 32.2 72 72 72 4.1 0 8.1-.5 12-1.2 9.6 28.5 36.2 49.2 68 49.2 39.8 0 72-32.2 72-72V64c0-35.3-28.7-64-64-64zm368 304c0-29.7-16.3-55.3-40.3-69.1 5.2-10.6 8.3-22.3 8.3-34.9 0-33.4-20.5-62-49.7-74 1-4.5 1.7-9.2 1.7-14 0-35.3-28.7-64-64-64-.8 0-1.5.2-2.2.2C422.7 20.5 397.9 0 368 0c-35.3 0-64 28.6-64 64v376c0 39.8 32.2 72 72 72 31.8 0 58.4-20.7 68-49.2 3.9.7 7.9 1.2 12 1.2 39.8 0 72-32.2 72-72 0-4.8-.5-9.5-1.4-14.1 29-12 49.4-40.6 49.4-73.9z"/></svg></span> Project 1: Differential isoform expression analysis of ONT data</h2>
<p>In this project, you will be working with data from the same resource as the data we have already worked on:</p>
<p>Clark, M. B. et al (2020). <em>Long-read sequencing reveals the complex splicing profile of the psychiatric risk gene CACNA1C in human brain</em>. Molecular Psychiatry, 25(1), 37–47. <a href="https://doi.org/10.1038/s41380-019-0583-1">https://doi.org/10.1038/s41380-019-0583-1</a>.</p>
<p>It is Oxford Nanopore Technology sequencing data of PCR amplicons of the gene CACNA1C. It is primarily used to discover new splice variants. We will use the dataset to do that and in addition do a differential isoform expression analysis with <a href="https://github.com/BrooksLabUCSC/flair">FLAIR</a>.</p>
<p>You can download the required data like this:</p>
<div class="highlight"><pre><span></span><code>wget https://ngs-longreads-training.s3.eu-central-1.amazonaws.com/groupwork_ont.tar.gz
tar -xvf groupwork_ont.tar.gz
rm groupwork_ont.tar.gz
</code></pre></div>
<p>This will create a directory <code>groupwork_ont</code> with the following structure:</p>
<div class="highlight"><pre><span></span><code>groupwork_ont
├── alignments
│   ├── cerebellum-5238-batch2.bam
│   ├── cerebellum-5298-batch2.bam
│   ├── cerebellum-5346-batch2.bam
│   ├── parietal_cortex-5238-batch1.bam
│   ├── parietal_cortex-5298-batch1.bam
│   └── parietal_cortex-5346-batch1.bam
├── counts
│   └── counts_matrix_test.tsv
├── reads
│   ├── cerebellum-5238-batch2.fastq.gz
│   ├── cerebellum-5298-batch2.fastq.gz
│   ├── cerebellum-5346-batch2.fastq.gz
│   ├── parietal_cortex-5238-batch1.fastq.gz
│   ├── parietal_cortex-5298-batch1.fastq.gz
│   ├── parietal_cortex-5346-batch1.fastq.gz
│   ├── striatum-5238-batch2.fastq.gz
│   ├── striatum-5298-batch2.fastq.gz
│   └── striatum-5346-batch2.fastq.gz
└── scripts
    └── differential_expression_example.Rmd

4 directories, 17 files
</code></pre></div>
<p>Download the fasta file and gtf like this:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> groupwork_ont/
mkdir reference
wget ftp://ftp.ensembl.org/pub/release-102/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.chromosome.12.fa.gz
wget ftp://ftp.ensembl.org/pub/release-102/gtf/homo_sapiens/Homo_sapiens.GRCh38.102.gtf.gz
gunzip *.gz
</code></pre></div>
<h3 id="before-you-start">Before you start</h3>
<p>You can start this project with dividing initial tasks. Because some intermediate files are already given, participants can develop scripts/analyses at different steps of the full analysis from the start. Possible starting points are:</p>
<ul>
<li>Quality control, running <code>fastqc</code> and <code>NanoPlot</code></li>
<li>Alignment, running <code>minimap2</code></li>
<li>Develop scripts required to run FLAIR</li>
<li>Differential expression analysis.</li>
</ul>
<h3 id="tasks-questions">Tasks &amp; questions</h3>
<ul>
<li>Perform QC with <code>fastqc</code> and with <code>NanoPlot</code>.<ul>
<li>Do you see a difference between them?</li>
<li>How is the read quality compared to the publication?</li>
</ul>
</li>
<li>Align each sample separately with <code>minimap2</code> with default parameters. Set parameters <code>-x</code> and <code>-G</code> to the values we have used during the <a href="../qc_alignment#3-read-alignment">QC and alignment exercises</a>. You can use 4 threads (set the number of threads with <code>-t</code>)</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">Start the alignment on day 1</p>
<p>The alignment takes about 6 minutes per sample, so in total about one hour to run. Make sure you have started the alignment at day 1, so you don&rsquo;t have to wait for the results on day 2. Use <code>nohup myscript.sh &amp;</code> to be able to logout while <code>myscript.sh</code> is running (<code>tmux</code> and <code>screen</code> are also available).</p>
</div>
<ul>
<li>Clone the <a href="https://github.com/BrooksLabUCSC/flair">FLAIR repository</a> to the server, and check out the documentation.</li>
<li>Merge the separate alignments with <code>samtools merge</code>, index the merged bam file, and generate a <code>bed12</code> file with the script <code>flair/bin/bam2Bed12.py</code></li>
<li>Run <code>flair.py correct</code> on the <code>bed12</code> file. Add the <code>gtf</code> to the options to improve the alignments.</li>
<li>Run <code>flair.py collapse</code> to generate isoforms from corrected reads. This steps takes ~1 hour to run.</li>
<li>Generate a count matrix with <code>flair.py quantify</code> by using the isoforms fasta and <code>reads_manifest.tsv</code>.</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">Paths in <code>reads_manifest.tsv</code></p>
<p>The paths in <code>reads_manifest.tsv</code> are relative, e.g. <code>reads/striatum-5238-batch2.fastq.gz</code> points to a file relative to the directory from which you are running <code>flair.py quantify</code>. So the directory from which you are running the command should contain the directory <code>reads</code>. If not, modify the paths in the file accordingly (use full paths if you are not sure).</p>
</div>
<ul>
<li>Now you can do several things:<ul>
<li>Do a differential expression analysis. In <code>scripts/</code> there&rsquo;s a basic R script to do the analysis. Go to <code>[SERVERIP]:8787</code> to login to RStudio server.</li>
<li>Investigate the isoform usage with the flair script <code>plot_isoform_usage.py</code></li>
<li>Investigate productivity of the different isoforms.</li>
</ul>
</li>
</ul>
<h2 id="project-2-repeat-expansion-analysis-of-pacbio-data"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M472.29 195.9l-67.06-23c-19.28-6.6-33.54-20.92-38.14-38.31l-16-60.45c-11.58-43.77-76.57-57.13-110-22.62L195 99.24c-13.26 13.71-33.54 20.93-54.2 19.31l-71.9-5.62c-52-4.07-86.93 44.89-59 82.84l38.54 52.42c11.08 15.07 12.82 33.86 4.64 50.24l-28.43 57C4 396.67 47.46 440.29 98.11 429.23l70-15.28c20.11-4.39 41.45 0 57.07 11.73l54.32 40.83c39.32 29.56 101 7.57 104.45-37.22l4.7-61.86c1.35-17.8 12.8-33.87 30.63-43l62-31.74c44.84-22.96 39.55-80.17-8.99-96.79zM160 256a32 32 0 1132-32 32 32 0 01-32 32zm128 96a32 32 0 1132-32 32 32 0 01-32 32zm16-128a16 16 0 1116-16 16 16 0 01-16 16z"/></svg></span> Project 2: Repeat expansion analysis of PacBio data</h2>
<p>You will be working with data from an experiment in which DNA of 8 individuals was sequenced for five different targets by using Pacbio&rsquo;s no-Amp targeted sequencing system. Two of these targets contain repeat expansions that are related to a disease phenotype.</p>
<table>
<thead>
<tr>
<th>individual</th>
<th>disease1</th>
<th>disease2</th>
</tr>
</thead>
<tbody>
<tr>
<td>1015</td>
<td>disease</td>
<td>healthy</td>
</tr>
<tr>
<td>1016</td>
<td>disease</td>
<td>healthy</td>
</tr>
<tr>
<td>1017</td>
<td>disease</td>
<td>healthy</td>
</tr>
<tr>
<td>1018</td>
<td>disease</td>
<td>healthy</td>
</tr>
<tr>
<td>1019</td>
<td>healthy</td>
<td>healthy</td>
</tr>
<tr>
<td>1020</td>
<td>healthy</td>
<td>disease</td>
</tr>
<tr>
<td>1021</td>
<td>healthy</td>
<td>disease</td>
</tr>
<tr>
<td>1022</td>
<td>healthy</td>
<td>disease</td>
</tr>
</tbody>
</table>
<p>You can get the reads and sequence targets with:</p>
<div class="highlight"><pre><span></span><code>wget https://ngs-longreads-training.s3.eu-central-1.amazonaws.com/groupwork_pacbio.tar.gz
tar -xvf groupwork_pacbio.tar.gz
rm groupwork_pacbio.tar.gz
</code></pre></div>
<p>It has the following directory structure:</p>
<div class="highlight"><pre><span></span><code>groupwork_pacbio
├── alignments
│   ├── bc1020.aln.bam
│   ├── bc1021.aln.bam
│   └── bc1022.aln.bam
├── reads
│   ├── 1015.fastq.gz
│   ├── 1016.fastq.gz
│   ├── 1017.fastq.gz
│   ├── 1018.fastq.gz
│   ├── 1019.fastq.gz
│   ├── 1020.fastq.gz
│   ├── 1021.fastq.gz
│   └── 1022.fastq.gz
└── targets
    ├── target_gene1_hg38.bed
    └── target_gene2_hg38.bed

3 directories, 13 files
</code></pre></div>
<p>The targets in gene1 and gene2 are described in <code>targets/target_gene1_hg38.bed</code> and <code>targets/target_gene2_hg38.bed</code> respectively. The columns in these <code>.bed</code> files describe the chromosome, start, end, name, motifs, and whether the motifs are in reverse complement.</p>
<p>You can download the reference genome like this:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> groupwork_pacbio
mkdir reference
wget ftp://ftp.ensembl.org/pub/release-101/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz
gunzip Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz
</code></pre></div>
<h3 id="before-you-start_1">Before you start</h3>
<p>You can start this project with dividing initial tasks. Because some intermediate files are already given, participants can develop scripts/analyses at different steps of the full analysis from the start. Possible starting points are:</p>
<ul>
<li>Browse IGV to find the genes</li>
<li>Perform the QC with <code>NanoPlot</code></li>
<li>Perform the alignment with <code>minimap2</code></li>
<li>Do the repeat analysis with <code>makeReports.sh</code></li>
</ul>
<p>Alignment files to do an initial repeat analysis are in the <code>tar.gz</code> package. However, it contains only the files for individuals with disease2. You can develop scripts and analyses based on that. To do the full analysis, all the alignments will need to be run.</p>
<h3 id="tasks-questions_1">Tasks &amp; questions</h3>
<ul>
<li>Load the bed files into IGV and navigate to the regions they annotate.<ul>
<li>In which genes are the targets?</li>
<li>What kind of diseases are associated with these genes?</li>
</ul>
</li>
<li>Perform a quality control with <code>NanoPlot</code>.<ul>
<li>How is the read quality? These are circular concensus sequences (ccs). Is this quality expected?</li>
<li>How is the read length?</li>
</ul>
</li>
<li>Align the reads to hg38 with <code>minimap2</code>. For the option <code>-x</code> you can use <code>asm20</code>. Generate separate alignment files for each individual.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Alternatively use <a href="https://github.com/PacificBiosciences/pbmm2"><code>pbmm2</code></a></p>
<p>Pacific Biosciences has developed a wrapper for <code>minimap2</code> that contains settings specific for PacBio reads, named <a href="https://github.com/PacificBiosciences/pbmm2"><code>pbmm2</code></a>. It might slightly improve your alignments. It is installed in the conda environment. Feel free to give it a try if you have time left.</p>
</div>
<ul>
<li>Clone the PacBio <a href="https://github.com/PacificBiosciences/apps-scripts.git">apps-scripts repository</a> to the server. The script apps-scripts/RepeatAnalysisTools/makeReports.sh generates repeat expansion reports. Check out the <a href="https://github.com/PacificBiosciences/apps-scripts/tree/master/RepeatAnalysisTools#auto-generate-all-reports">documentation</a>, and generate repeat expansion reports for all individuals on both gene1 and gene2.</li>
<li>Check out the report output and read the further <a href="https://github.com/PacificBiosciences/apps-scripts/tree/master/RepeatAnalysisTools#auto-generate-all-reports">documentation of RepeatAnalysisTools</a>.<ul>
<li>How is the enrichment?</li>
<li>Does the clustering make sense? How does the clustering look in IGV?</li>
<li>Which individual is affected with which disease?</li>
<li>Based on the size of the expansions, can you say something about expected disease severity?</li>
</ul>
</li>
</ul>
<blockquote>
<p>This tutorial is based on data provided by Pacific Biosciences at https://downloads.pacbcloud.com/public/dataset/RepeatExpansionDisorders_NoAmp/</p>
</blockquote>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../downstream_analyses/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Downstream analyses
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>