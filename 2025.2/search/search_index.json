{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#teachers","title":"Teachers","text":"<ul> <li>Geert van Geest  </li> </ul>"},{"location":"#authors","title":"Authors","text":"<ul> <li>Geert van Geest  </li> <li>Marco Kreuzer  </li> <li>Patricia Palagi  </li> </ul>"},{"location":"#learning-outcomes","title":"Learning outcomes","text":""},{"location":"#general-learning-outcomes","title":"General learning outcomes","text":"<p>After this course, you will be able to:</p> <ul> <li>Describe the basics behind PacBio SMRT sequencing and Oxford Nanopore Technology sequencing</li> <li>Use the command line to perform quality control and read alignment of long-read sequencing data</li> <li>Develop and execute a bioinformatics pipeline to perform an alignment-based analysis</li> <li>Answer biological questions based on the analysis resulting from the pipeline</li> </ul>"},{"location":"#learning-outcomes-explained","title":"Learning outcomes explained","text":"<p>To reach the general learning outcomes above, we have set a number of smaller learning outcomes. Each chapter (found at Course material) starts with these smaller learning outcomes. Use these at the start of a chapter to get an idea what you will learn. Use them also at the end of a chapter to evaluate whether you have learned what you were expected to learn.</p>"},{"location":"#learning-experiences","title":"Learning experiences","text":"<p>To reach the learning outcomes we will use lectures, exercises, polls and group work. During exercises, you are free to discuss with other participants. During lectures, focus on the lecture only.</p>"},{"location":"#exercises","title":"Exercises","text":"<p>Each block has practical work involved. Some more than others. The practicals are subdivided into chapters, and we\u2019ll have a (short) discussion after each chapter. All answers to the practicals are incorporated, but they are hidden. Do the exercise first by yourself, before checking out the answer. If your answer is different from the answer in the practicals, try to figure out why they are different.</p>"},{"location":"#asking-questions","title":"Asking questions","text":"<p>During lectures, you are encouraged to raise your hand if you have questions (if in-person), or use the Zoom functionality (if online). Find the buttons in the participants list (\u2018Participants\u2019 button):</p> <p>Alternatively, (depending on your zoom version or OS) use the \u2018Reactions\u2019 button:</p> <p>A main source of communication will be our slack channel. Ask background questions that interest you personally at #background. During the exercises, e.g. if you are stuck or don\u2019t understand what is going on, use the slack channel #q-and-a.  This channel is not only meant for asking questions but also for answering questions of other participants. If you are replying to a question, use the \u201creply in thread\u201d option:</p> <p>The teacher will review the answers, and add/modify if necessary. If you\u2019re really stuck and need specific tutor support, write the teachers or helpers personally.</p> <p>To summarise:</p> <ul> <li>During lectures: raise hand/zoom functionality</li> <li>Personal interest questions: #background</li> <li>During exercises: #q-and-a on slack</li> </ul>"},{"location":"course_schedule/","title":"Course schedule","text":""},{"location":"course_schedule/#day-1","title":"Day 1","text":"block start end subject block 1 9:15 AM 10:30 AM Introduction 10:30 AM 11:00 AM BREAK block 2 11:00 AM 12:30 PM Server login + unix fresh up 12:30 PM 1:30 PM BREAK block 3 1:30 PM 3:00 PM Applicationns - PacBio 3:00 PM 3:30 PM BREAK block 4 3:30 PM 5:15 PM Quality control and Read alignment"},{"location":"course_schedule/#day-2","title":"Day 2","text":"block start end subject block 1 9:15 AM 10:00 AM Talk + Q&amp;A with Alban Ramette (ONT) 10:00 AM 10:30 AM BREAK block 2 10:30 AM 11:30 PM Talk + Q&amp;A with Pamela Nicholson (PacBio) block 3 11:30 AM 12:30 PM Applications + Group work 12:30 PM 1:30 PM BREAK block 4 1:30 PM 3:00 PM Group work 3:00 PM 3:30 PM BREAK block 5 3:30 PM 5:15 PM Presentations"},{"location":"precourse/","title":"Precourse preparations","text":""},{"location":"precourse/#unix","title":"UNIX","text":"<p>As is stated in the course prerequisites at the announcement web page, we expect participants to have a basic understanding of working with the command line on UNIX-based systems. You can test your UNIX skills with a quiz here. If you don\u2019t have experience with UNIX command line, or if you\u2019re unsure whether you meet the prerequisites, follow our online UNIX tutorial.</p>"},{"location":"precourse/#software","title":"Software","text":"<p>We will be mainly working on an Amazon Web Services (AWS) Elastic Cloud (EC2) server. Our Ubuntu server behaves like a \u2018normal\u2019 remote server, and can be approached through a VS code web interface. All participants will be granted access to a personal workspace to be used during the course.</p> <p>The only software you need to install before the course is Integrative Genomics Viewer (IGV).</p>"},{"location":"course_material/applications/","title":"Applications","text":""},{"location":"course_material/applications/#learning-outcomes","title":"Learning outcomes","text":"<p>After having completed this chapter you will be able to:</p> <ul> <li>Explain for what kind of questions long-read sequencing technologies are more suitable compared to short-read sequencing technologies.</li> <li>Describe the basic steps that are required to perform a genome assembly</li> </ul>"},{"location":"course_material/applications/#material","title":"Material","text":"<p> Download the presentation</p> <ul> <li>More on adaptive sampling</li> <li>More on Cas9 targeted sequencing ONT</li> <li>long-read-tools.org</li> </ul>"},{"location":"course_material/introduction/","title":"Introduction","text":""},{"location":"course_material/introduction/#learning-outcomes","title":"Learning outcomes","text":"<p>After having completed this chapter you will be able to:</p> <ul> <li>Illustrate the difference between short-read and long-read sequencing</li> <li>Explain which type of invention led to development of long-read sequencing</li> <li>Describe the basic techniques behind Oxford Nanopore sequencing and PacBio sequencing</li> <li>Choose based on the characteristics of the discussed sequencing platforms which one is most suited for different situations</li> </ul>"},{"location":"course_material/introduction/#material","title":"Material","text":"<ul> <li>The introduction presentation:</li> </ul> <p> Download the presentation</p> <ul> <li>The sequencing technologies presentation:</li> </ul> <p> Download the presentation</p> <ul> <li>Nice review on long read sequencing in humans (also relevant for other species)</li> <li>Review on long read sequencing data analysis</li> </ul>"},{"location":"course_material/qc_alignment/","title":"QC and alignment","text":""},{"location":"course_material/qc_alignment/#learning-outcomes","title":"Learning outcomes","text":"<p>After having completed this chapter you will be able to:</p> <ul> <li>Explain how the fastq format stores sequence and base quality information and why this is limited for long-read sequencing data</li> <li>Calculate base accuracy and probability based on base quality</li> <li>Describe how alignment information is stored in a sequence alignment (<code>.sam</code>) file</li> <li>Perform a quality control on long-read data with <code>NanoPlot</code></li> <li>Perform a basic alignment of long reads with <code>minimap2</code></li> <li>Visualise an alignment file in IGV on a local computer</li> </ul>"},{"location":"course_material/qc_alignment/#material","title":"Material","text":"<p> Download the presentation</p>"},{"location":"course_material/qc_alignment/#exercises","title":"Exercises","text":""},{"location":"course_material/qc_alignment/#1-retrieve-data","title":"1. Retrieve data","text":"<p>We will be working with data from:</p> <p>Padilla, Juan-Carlos A., Seda Barutcu, Ludovic Malet, Gabrielle Deschamps-Francoeur, Virginie Calderon, Eunjeong Kwon, and Eric L\u00e9cuyer. \u201cProfiling the Polyadenylated Transcriptome of Extracellular Vesicles with Long-Read Nanopore Sequencing.\u201d BMC Genomics 24, no. 1 (September 22, 2023): 564. https://doi.org/10.1186/s12864-023-09552-6.</p> <p>The authors used RNA sequencing with Oxford Nanopore Technology of both extracellular vesicles and whole cells from cell culture.</p> <p>For the exercises of today, we will work with two samples of this study. Download and unpack the data files in your home directory.</p> <pre><code>cd ~/project\nwget https://ngs-longreads-training.s3.eu-central-1.amazonaws.com/project1.tar.gz\ntar -xvf project1.tar.gz\nrm project1.tar.gz\n</code></pre> <p>Exercise: This will create the directory called <code>project1</code>. Check out what\u2019s in there.</p> Answer <p>Go to the <code>~/project/project1</code> folder:</p> <pre><code>cd ~/project/project1\n</code></pre> <p>The data folder contains the following: <pre><code>project1/\n\u251c\u2500\u2500 reads\n\u2502   \u251c\u2500\u2500 Cell_1.fastq.gz\n\u2502   \u251c\u2500\u2500 Cell_2.fastq.gz\n\u2502   \u251c\u2500\u2500 Cell_3.fastq.gz\n\u2502   \u251c\u2500\u2500 EV_1.fastq.gz\n\u2502   \u251c\u2500\u2500 EV_2.fastq.gz\n\u2502   \u2514\u2500\u2500 EV_3.fastq.gz\n\u251c\u2500\u2500 reads_manifest.tsv\n\u2514\u2500\u2500 references\n    \u251c\u2500\u2500 Homo_sapiens.GRCh38.111.chr5.chr6.chrX.gtf\n    \u2514\u2500\u2500 Homo_sapiens.GRCh38.dna.primary_assembly.chr5.chr6.chrX.fa\n\n2 directories, 9 files\n</code></pre> In the reads folder a fastq file with reads, which are described in <code>reads_manifest.csv</code>. EV means \u2018extracellular vesicle\u2019, Cell means \u2018entire cells\u2019. In the references folder you can find the reference sequence and annotation.</p>"},{"location":"course_material/qc_alignment/#2-quality-control","title":"2. Quality control","text":"<p>Activate the conda environment</p> <p>The tools you will be needed for these exercises are in the conda environment <code>lr-tools</code>. Every time you open a new terminal, activate it with:</p> <pre><code>conda activate lr-tools\n</code></pre> <p>We will evaluate the read quality of two fastq files with <code>NanoPlot</code>.</p> <p>Exercise: Check out the manual of <code>NanoPlot</code> with the command <code>NanoPlot --help</code>. After that run <code>NanoPlot</code> on </p> <ul> <li><code>reads/Cell_2.fastq.gz</code></li> <li><code>reads/EV_2.fastq.gz</code>. </li> </ul> <p>Your fastq files are in the \u2018rich\u2019 format, meaning they have additional information regarding the ONT run. </p> Hint <p>For a basic output of <code>NanoPlot</code> on a <code>fastq.gz</code> file you can use the options <code>--outdir</code> and <code>--fastq_rich</code>.</p> Answer <p>We have a rich <code>fastq</code> file, so based on the manual and the example we can run:</p> <pre><code>cd ~/project/project1\n\nmkdir -p nanoplot\n\nNanoPlot \\\n--fastq_rich reads/Cell_2.fastq.gz \\\n--outdir nanoplot/Cell_2\n\nNanoPlot \\\n--fastq_rich reads/EV_2.fastq.gz \\\n--outdir nanoplot/EV_2\n</code></pre> <p>In both directories you will now have a directory with the following files:</p> <pre><code>.\n\u251c\u2500\u2500 ActivePores_Over_Time.html\n\u251c\u2500\u2500 ActivePores_Over_Time.png\n\u251c\u2500\u2500 ActivityMap_ReadsPerChannel.html\n\u251c\u2500\u2500 ActivityMap_ReadsPerChannel.png\n\u251c\u2500\u2500 CumulativeYieldPlot_Gigabases.html\n\u251c\u2500\u2500 CumulativeYieldPlot_Gigabases.png\n\u251c\u2500\u2500 CumulativeYieldPlot_NumberOfReads.html\n\u251c\u2500\u2500 CumulativeYieldPlot_NumberOfReads.png\n\u251c\u2500\u2500 LengthvsQualityScatterPlot_dot.html\n\u251c\u2500\u2500 LengthvsQualityScatterPlot_dot.png\n\u251c\u2500\u2500 LengthvsQualityScatterPlot_kde.html\n\u251c\u2500\u2500 LengthvsQualityScatterPlot_kde.png\n\u251c\u2500\u2500 NanoPlot_20240221_1219.log\n\u251c\u2500\u2500 NanoPlot-report.html\n\u251c\u2500\u2500 NanoStats.txt\n\u251c\u2500\u2500 Non_weightedHistogramReadlength.html\n\u251c\u2500\u2500 Non_weightedHistogramReadlength.png\n\u251c\u2500\u2500 Non_weightedLogTransformed_HistogramReadlength.html\n\u251c\u2500\u2500 Non_weightedLogTransformed_HistogramReadlength.png\n\u251c\u2500\u2500 NumberOfReads_Over_Time.html\n\u251c\u2500\u2500 NumberOfReads_Over_Time.png\n\u251c\u2500\u2500 TimeLengthViolinPlot.html\n\u251c\u2500\u2500 TimeLengthViolinPlot.png\n\u251c\u2500\u2500 TimeQualityViolinPlot.html\n\u251c\u2500\u2500 TimeQualityViolinPlot.png\n\u251c\u2500\u2500 WeightedHistogramReadlength.html\n\u251c\u2500\u2500 WeightedHistogramReadlength.png\n\u251c\u2500\u2500 WeightedLogTransformed_HistogramReadlength.html\n\u251c\u2500\u2500 WeightedLogTransformed_HistogramReadlength.png\n\u251c\u2500\u2500 Yield_By_Length.html\n\u2514\u2500\u2500 Yield_By_Length.png\n\n0 directories, 31 files\n</code></pre> <p>The file <code>NanoPlot-report.html</code> contains a report with all the information stored in the other files, and <code>NanoStats.txt</code> in text format.</p> <p>Exercise: Check out some of the .png plots and the contents of <code>NanoStats.txt</code>. Also, download <code>NanoPlot-report.html</code> for both files to your local computer and answer the following questions:</p> <p>A. How many reads are in the files?</p> <p>B. What are the average read lengths? What does this tell us about the quality of both runs?</p> <p>C. What is the average base quality and what kind of accuracy do we therefore expect?</p> <p>D. Browse through the report and check out the other plots. Was there a site dependency in the number of reads per channel? Would a longer sequencing run have been beneficial?</p> <p>Download files from the notebook</p> <p>You can download files from the file browser, by right-clicking a file and selecting Download\u2026:</p> <p> </p> Answer <p>A. Cell_2: 49,808 reads; EV_2: 6,214 reads </p> <p>B. Cell_2: 1186.7 EV_2: 607.9. Both runs are form cDNA. Transcripts are usually around 1-2kb. The average read length is therefore quite short in sample EV_2. </p> <p>C. The median base quality is for both around 12. This means that the error probability is about 10^(-12/10) = 0.06, so an accuracy of 94%. </p> <p>D. The number of reads per channel is variable (check out \u2018Number of reads generated per channel\u2019). There is a spot in the middle of the flow cell with channels with very low activity. Both the cumulative yield plots and the number of reads over time plots show that the run was reaching saturation. A longer run would not have been beneficial.</p>"},{"location":"course_material/qc_alignment/#3-read-alignment","title":"3. Read alignment","text":"<p>The sequence aligner <code>minimap2</code> is specifically developed for (splice-aware) alignment of long reads.</p> <p>Exercise: Checkout the helper <code>minimap2 --help</code> and/or the github readme. We are working with reads generated from cDNA. Considering we are aligning to a reference genome (DNA), what would be the most logical parameter for our dataset to the option <code>-x</code>?</p> Answer <p>The option <code>-x</code> can take the following arguments:</p> <p><pre><code>-x STR       preset (always applied before other options; see minimap2.1 for details) []\n           - map-pb/map-ont: PacBio/Nanopore vs reference mapping\n           - ava-pb/ava-ont: PacBio/Nanopore read overlap\n           - asm5/asm10/asm20: asm-to-ref mapping, for ~0.1/1/5% sequence divergence\n           - splice: long-read spliced alignment\n           - sr: genomic short-read mapping\n</code></pre> We are working with ONT data so we could choose <code>map-ont</code>. However, our data is also spliced. Therefore, we should choose <code>splice</code>.</p> <p>Exercise: Make a directory called <code>alignments</code> in your working directory. After that, modify the command below for <code>minimap2</code> and run it from a script; i.e. replace [PARAMETER] with the correct option.</p> <pre><code>#!/usr/bin/env bash\n\ncd ~/project/project1\n\nmkdir -p alignments\n\nfor sample in EV_2 Cell_2; do\n    minimap2 \\\n    -a \\\n    -x [PARAMETER] \\\n    -t 4 \\\n    references/Homo_sapiens.GRCh38.dna.primary_assembly.chr5.chr6.chrX.fa \\\n    reads/\"$sample\".fastq.gz \\\n    | samtools sort \\\n    | samtools view -bh &gt; alignments/\"$sample\".bam\n\n    ## indexing for IGV\n    samtools index alignments/\"$sample\".bam\ndone\n</code></pre> <p>Note</p> <p>Once your script is running, it will take a while to finish. Have a \u2615. </p> Answer <p>Modify the script to set the <code>-x</code> option:</p> <pre><code>#!/usr/bin/env bash\n\ncd ~/project/project1\n\nmkdir -p alignments\n\nfor sample in EV_2 Cell_2; do\n    minimap2 \\\n    -a \\\n    -x splice \\\n    -t 4 \\\n    references/Homo_sapiens.GRCh38.dna.primary_assembly.chr5.chr6.chrX.fa \\\n    reads/\"$sample\".fastq.gz \\\n    | samtools sort \\\n    | samtools view -bh &gt; alignments/\"$sample\".bam\n\n    ## indexing for IGV\n    samtools index alignments/\"$sample\".bam\ndone\n</code></pre> <p>And run it (e.g. if you named the script <code>ont_alignment.sh</code>):</p> <pre><code>chmod u+x ont_alignment.sh\n./ont_alignment.sh\n</code></pre>"},{"location":"course_material/qc_alignment/#4-visualisation","title":"4. Visualisation","text":"<p>Let\u2019s have a look at the alignments. Download the files (in <code>~/project/project1/alignments</code>):</p> <ul> <li><code>EV_2.bam</code></li> <li><code>EV_2.bam.bai</code> </li> <li><code>Cell_2.bam</code></li> <li><code>Cell_2.bam.bai</code> </li> </ul> <p>to your local computer and load the <code>.bam</code> files into IGV (File &gt; Load from File\u2026).</p> <p>Exercise: Have a look at the gene <code>ELOVL5</code> by typing the name into the search box. </p> <ul> <li>Do you see any evidence for alternative splicing already?</li> <li>How is the difference in quality between the two samples? Would that have an effect on estimating differential splicing? </li> </ul> <p>Check out the paper</p> <p>The authors found splice variants. Check figure 5B in the paper.</p> Answer <p>There is some observable exon skipping in Cell_2:</p> <p> </p> <p>The coverage of EV_2 is quite low. Also, a lot of the reads do not fully cover the gene. This will make it difficult to estimate differential splicing.</p>"},{"location":"course_material/server_login/","title":"Server login","text":""},{"location":"course_material/server_login/#learning-outcomes","title":"Learning outcomes","text":"<p>Note</p> <p>You might already be able to do some or all of these learning outcomes. If so, you can go through the corresponding exercises quickly. The general aim of this chapter is to work comfortably on a remote server by using the command line.</p> <p>After having completed this chapter you will be able to:</p> <ul> <li>Use the command line to:<ul> <li>Make a directory</li> <li>Change file permissions to \u2018executable\u2019</li> <li>Run a <code>bash</code> script</li> <li>Pipe data from and to a file or other executable</li> </ul> </li> <li>Program a loop in <code>bash</code></li> </ul> <p>Choose your platform</p> <p>In this part we will show you how to access the cloud server, or setup your computer to do the exercises with conda or with Docker.</p> <p>If you are doing the course with a teacher, you will have to login to the remote server. Therefore choose:</p> <ul> <li>Cloud notebook</li> </ul> <p>If you are doing this course independently (i.e. without a teacher) choose either:</p> <ul> <li>conda</li> <li>Docker</li> </ul> Cloud notebookDocker"},{"location":"course_material/server_login/#exercises","title":"Exercises","text":""},{"location":"course_material/server_login/#first-login","title":"First login","text":"<p>If you are participating in this course with a teacher, you have received a link and a password. Copy-paste the link (including the port, e.g.: <code>http://12.345.678.91:10002</code>) in your browser. This should result in the following page:</p> <p> </p> <p>Info</p> <p>The link gives you access to a web version of Visual Studio Code. This is a powerful code editor that you can also use as a local application on your computer. </p> <p>Type in the password that was provided to you by the teacher. Now let\u2019s open the terminal. You can do that with ++ctrl+grave++. Or by clicking Application menu &gt; Terminal &gt; New Terminal:</p> <p> </p> <p>For a.o. efficiency and reproducibility it makes sense to execute your commands from a script. With use of the \u2018new file\u2019 button:</p> <p> </p>"},{"location":"course_material/server_login/#material","title":"Material","text":"<ul> <li>Instructions to install docker</li> <li>Instructions to set up to container</li> </ul>"},{"location":"course_material/server_login/#exercises_1","title":"Exercises","text":""},{"location":"course_material/server_login/#first-login_1","title":"First login","text":"<p>Docker can be used to run an entire isolated environment in a container. This means that we can run the software with all its dependencies required for this course locally in your computer. Independent of your operating system.</p> <p>In the video below there\u2019s a tutorial on how to set up a docker container for this course. Note that you will need administrator rights, and that if you are using Windows, you need the latest version of Windows 10.</p> <p></p> <p>The command to run the environment required for this course looks like this (in a terminal):</p> <p>Modify the script</p> <p>Modify the path after <code>-v</code> to the working directory on your computer before running it.</p> <pre><code>docker run \\\n--rm \\\n-p 8443:8443 \\\n-e PUID=1000 \\\n-e PGID=1000 \\\n-e DEFAULT_WORKSPACE=/config/project \\\n-v $PWD:/config/project \\\ngeertvangeest/ngs-longreads-vscode:latest\n</code></pre> <p>If this command has run successfully, navigate in your browser to http://localhost:8443.</p> <p>The option <code>-v</code> mounts a local directory in your computer to the directory <code>/config/project</code> in the docker container. In that way, you have files available both in the container and on your computer. Use this directory on your computer to e.g. visualise data with IGV. Change the first path to a path on your computer that you want to use as a working directory.</p> <p>Don\u2019t mount directly in the home dir</p> <p>Don\u2019t directly mount your local directory to the home directory (<code>/root</code>). This will lead to unexpected behaviour.</p> <p>The part <code>geertvangeest/ngs-longreads-vscode:latest</code> is the image we are going to load into the container. The image contains all the information about software and dependencies needed for this course. When you run this command for the first time it will download the image. Once it\u2019s on your computer, it will start immediately.</p>"},{"location":"course_material/server_login/#a-unix-command-line-interface-cli-refresher","title":"A UNIX command line interface (CLI) refresher","text":"<p>Most bioinformatics software are UNIX based and are executed through the CLI. When working with NGS data, it is therefore convenient to improve your knowledge on UNIX. For this course, we need basic understanding of UNIX CLI, so here are some exercises to refresh your memory. </p> <p>If you need some reminders of the commands, here\u2019s a link to a UNIX command line cheat sheet:</p> <p> UNIX cheat sheet</p>"},{"location":"course_material/server_login/#make-a-new-directory","title":"Make a new directory","text":"<p>Make a directory <code>scripts</code> within <code>~/project</code> and make it your current directory.</p> Answer <pre><code>cd ~/project\nmkdir scripts\ncd scripts\n</code></pre>"},{"location":"course_material/server_login/#file-permissions","title":"File permissions","text":"<p>Generate an empty script in your newly made directory <code>~/project/scripts</code> like this:</p> <pre><code>touch new_script.sh\n</code></pre> <p>Add a command to this script that writes \u201cSIB courses are great!\u201d (or something you can better relate to.. ) to stdout, and try to run it.</p> Answer <p>Generate a script as described above. The script should look like this:</p> <pre><code>#!/usr/bin/env bash\n\necho \"SIB courses are great!\"\n</code></pre> <p>Usually, you can run it like this:</p> <pre><code>./new_script.sh\n</code></pre> <p>But there\u2019s an error:</p> <pre><code>bash: ./new_script.sh: Permission denied\n</code></pre> <p>Why is there an error?</p> <p>Hint</p> <p>Use <code>ls -lh new_script.sh</code> to check the permissions.</p> Answer <pre><code>ls -lh new_script.sh\n</code></pre> <p>gives:</p> <pre><code>-rw-r--r--  1 user  group    51B Nov 11 16:21 new_script.sh\n</code></pre> <p>There\u2019s no <code>x</code> in the permissions string. You should change at least the permissions of the user.</p> <p>Make the script executable for yourself, and run it.</p> Answer <p>Change permissions:</p> <pre><code>chmod u+x new_script.sh\n</code></pre> <p><code>ls -lh new_script.sh</code> now gives:</p> <pre><code>-rwxr--r--  1 user  group    51B Nov 11 16:21 new_script.sh\n</code></pre> <p>So it should be executable:</p> <pre><code>./new_script.sh\n</code></pre> <p>More on <code>chmod</code> and file permissions here.</p>"},{"location":"course_material/server_login/#redirection-and","title":"Redirection: <code>&gt;</code> and <code>|</code>","text":"<p>In the root directory (go there like this: <code>cd /</code>) there are a range of system directories and files. Write the names of all directories and files to a file called <code>system_dirs.txt</code> in your working directory.</p> Answer <pre><code>ls / &gt; ~/project/system_dirs.txt\n</code></pre> <p>The command <code>wc -l</code> counts the number of lines, and can read from stdin. Make a one-liner with a pipe <code>|</code> symbol to find out how many system directories and files there are.</p> Answer <pre><code>ls / | wc -l\n</code></pre>"},{"location":"course_material/server_login/#variables","title":"Variables","text":"<p>Store <code>system_dirs.txt</code> as variable (like this: <code>VAR=variable</code>), and use <code>wc -l</code> on that variable to count the number of lines in the file.</p> Answer <pre><code>FILE=~/project/system_dirs.txt\nwc -l $FILE\n</code></pre>"},{"location":"course_material/server_login/#shell-scripts","title":"shell scripts","text":"<p>Make a shell script that automatically counts the number of system directories and files.</p> Answer <p>Make a script called e.g. <code>current_system_dirs.sh</code>: <pre><code>#!/usr/bin/env bash\ncd /\nls | wc -l\n</code></pre></p>"},{"location":"course_material/group_work/group_work/","title":"Introduction","text":""},{"location":"course_material/group_work/group_work/#learning-outcomes","title":"Learning outcomes","text":"<p>After having completed this chapter you will be able to:</p> <ul> <li>Develop a basic pipeline for alignment-based analysis of a long-read sequencing dataset</li> <li>Answer biological questions based on the analysis resulting from the pipeline</li> </ul>"},{"location":"course_material/group_work/group_work/#introduction","title":"Introduction","text":"<p>The last part of this course will consist of project-based-learning. This means that you will work in groups on a single question. We will split up into groups of five people.</p> <p>If working independently</p> <p>If you are working independently, you probably can not work in a group. However, you can test your skills with these real biological datasets. Realize that the datasets and calculations are (much) bigger compared to the exercises, so check if your computer is up for it. You\u2019ll probably need around 4 cores, 16G of RAM and 10G of harddisk.</p> <p>If online</p> <p>If the course takes place online, we will use break-out rooms to communicate within groups. Please stay in the break-out room during the day, also if you are working individually.</p>"},{"location":"course_material/group_work/group_work/#roles-organisation","title":"Roles &amp; organisation","text":"<p>Project based learning is about learning by doing, but also about peer instruction. This means that you will be both a learner and a teacher. There will be differences in levels among participants, but because of that, some will learn efficiently from people that have just learned, and others will teach and increase their understanding.</p> <p>Each project has tasks and questions. By performing the tasks, you should be able to answer the questions. At the start of the project, make sure that each of you gets a task assigned. You should consider the tasks and questions as a guidance. If interesting questions pop up during the project, you are encouraged to work on those. Also, you don\u2019t have to perform all the tasks and answer all the questions.</p> <p>In the afternoon of day 1, you will divide the initial tasks, and start on the project. On day 2, you can work on the project in the morning and in the first part of the afternoon. We will conclude the projects with a 10-minute presentation of each group.</p>"},{"location":"course_material/group_work/group_work/#working-directories","title":"Working directories","text":"<p>Each group has access to a shared working directory. It is mounted in the root directory (<code>/group_work/groupX</code>). You can add the group work directory to the workspace in VScode by opening the menu on the top right (hamburger symbol), click File &gt; Add folder to workspace and type the path to the group work directory.</p>"},{"location":"course_material/group_work/project1/","title":"Project 1","text":""},{"location":"course_material/group_work/project1/#project-1-differential-isoform-expression-analysis-of-ont-data","title":"Project 1: Differential isoform expression analysis of ONT data","text":"<p>In this project, you will be working with data from the same resource as the data we have already worked on:</p> <p>Padilla, Juan-Carlos A., Seda Barutcu, Ludovic Malet, Gabrielle Deschamps-Francoeur, Virginie Calderon, Eunjeong Kwon, and Eric L\u00e9cuyer. \u201cProfiling the Polyadenylated Transcriptome of Extracellular Vesicles with Long-Read Nanopore Sequencing.\u201d BMC Genomics 24, no. 1 (September 22, 2023): 564. https://doi.org/10.1186/s12864-023-09552-6.</p> <p>It is Oxford Nanopore Technology sequencing data of cDNA from extracellular vesicles and whole cells. It is primarily used to discover new splice variants. We will use the dataset to do that and in addition do a differential isoform expression analysis with FLAIR.</p> <p>Project aim</p> <p>Discover new splice variants and identify differentially expressed isoforms.</p> <p>You can download the required data like this:</p> <pre><code>wget https://ngs-longreads-training.s3.eu-central-1.amazonaws.com/project1.tar.gz\ntar -xvf project1.tar.gz\nrm project1.tar.gz\n</code></pre> <p>Note</p> <p>Download the data file package in your shared working directory, i.e. : <code>/group_work/&lt;group name&gt;</code>. Only one group member has to do this. You can add the group work directory to the workspace in VScode by opening the menu on the top right (hamburger symbol), click File &gt; Add folder to workspace and type the path to the group work directory.</p> <p>This will create a directory <code>project1</code> with the following structure:</p> <pre><code>project1/\n\u251c\u2500\u2500 reads\n\u2502   \u251c\u2500\u2500 Cell_1.fastq.gz\n\u2502   \u251c\u2500\u2500 Cell_2.fastq.gz\n\u2502   \u251c\u2500\u2500 Cell_3.fastq.gz\n\u2502   \u251c\u2500\u2500 EV_1.fastq.gz\n\u2502   \u251c\u2500\u2500 EV_2.fastq.gz\n\u2502   \u2514\u2500\u2500 EV_3.fastq.gz\n\u251c\u2500\u2500 reads_manifest.tsv\n\u2514\u2500\u2500 references\n    \u251c\u2500\u2500 Homo_sapiens.GRCh38.111.chr5.chr6.chrX.gtf\n    \u2514\u2500\u2500 Homo_sapiens.GRCh38.dna.primary_assembly.chr5.chr6.chrX.fa\n\n2 directories, 9 files\n</code></pre> <p>In the reads folder a fastq file with reads, which are described in <code>reads_manifest.csv</code>. EV means \u2018extracellular vesicle\u2019, Cell means \u2018entire cells\u2019. In the references folder you can find the reference sequence and annotation.</p>"},{"location":"course_material/group_work/project1/#before-you-start","title":"Before you start","text":"<p>You can start this project with dividing initial tasks. Because some intermediate files are already given, participants can develop scripts/analyses at different steps of the full analysis from the start. Possible starting points are:</p> <ul> <li>Quality control, running <code>fastqc</code> and <code>NanoPlot</code></li> <li>Alignment, running <code>minimap2</code></li> <li>Develop scripts required to run FLAIR</li> <li>Differential expression analysis.</li> </ul>"},{"location":"course_material/group_work/project1/#tasks-questions","title":"Tasks &amp; questions","text":"<p>Activate the conda environment</p> <p>The tools you will be needed for these exercises are in the conda environment <code>flair</code>. Every time you open a new terminal, activate it with:</p> <pre><code>conda activate flair\n</code></pre> <ul> <li> <p>Perform QC with <code>fastqc</code> and with <code>NanoPlot</code>. Is <code>fastqc</code> appropriate enough for long reads? Do you see a difference between the programs?</p> </li> <li> <p>Align each sample separately with <code>minimap2</code> with default parameters. Set parameters <code>-x</code> and <code>-G</code> to the values we have used during the QC and alignment exercises. You can use 4 threads (set the number of threads with <code>-t</code>)</p> </li> </ul> <p>Start the alignment as soon as possible</p> <p>The alignment takes about 6 minutes per sample, so in total about one hour to run. Try to start the alignment as soon as possible. You can speed up your alignment by first making an index, e.g.:</p> <pre><code>minimap2 \\\n-x splice \\\n-d reference/Homo_sapiens.GRCh38.dna.chromosome.12.fa.mmi \\\nreference/Homo_sapiens.GRCh38.dna.chromosome.12.fa\n</code></pre> <p>Refer to the generated index (<code>.mmi</code> file) as reference in the alignment command, e.g.:</p> <pre><code>minimap2 \\\n-a \\\n-x splice \\\n-G 500k \\\n-t 4 \\\nreference/Homo_sapiens.GRCh38.dna.chromosome.12.fa.mmi \\\nreads/&lt;my_reads.fastq.gz&gt;\n</code></pre> <ul> <li>Have a look at the FLAIR documentation.</li> <li>FLAIR and all its dependencies are in the the pre-installed conda environment named <code>flair</code>. You can activate it with <code>conda activate flair</code>.</li> <li>Merge the separate alignments with <code>samtools merge</code>, index the merged bam file, and generate a <code>bed12</code> file with the command <code>bam2Bed12</code></li> <li>Run <code>flair correct</code> on the <code>bed12</code> file. Add the <code>gtf</code> to the options to improve the alignments.</li> <li>Run <code>flair collapse</code> to generate isoforms from corrected reads. This steps takes ~1.5 hours to run.</li> <li>Generate a count matrix with <code>flair quantify</code> by using the isoforms fasta and <code>reads_manifest.tsv</code> (takes ~45 mins to run).</li> </ul> <p>Paths in <code>reads_manifest.tsv</code></p> <p>The paths in <code>reads_manifest.tsv</code> are relative, e.g. <code>reads/striatum-5238-batch2.fastq.gz</code> points to a file relative to the directory from which you are running <code>flair quantify</code>. So the directory from which you are running the command should contain the directory <code>reads</code>. If not, modify the paths in the file accordingly (use full paths if you are not sure).</p> <ul> <li>Now you can do several things:<ul> <li>Do a differential expression analysis. In <code>scripts/</code> there\u2019s a basic R script to do the analysis. Go to your specified IP and port to login to RStudio server (the username is <code>rstudio</code>).</li> <li>Investigate the isoform usage with the flair script <code>plot_isoform_usage.py</code></li> <li>Investigate productivity of the different isoforms.</li> </ul> </li> </ul>"},{"location":"course_material/group_work/project2/","title":"Project 2","text":""},{"location":"course_material/group_work/project2/#project-2-repeat-expansion-analysis-of-pacbio-data","title":"Project 2: Repeat expansion analysis of PacBio data","text":"<p>You will be working with data from an experiment in which DNA of 8 individuals was sequenced for five different targets by using Pacbio\u2019s no-Amp targeted sequencing system. Two of these targets contain repeat expansions that are related to a disease phenotype.</p> <p>Project aim</p> <p>Estimate variation in repeat expansions in two target regions, and relate them to a disease phenotype.</p> individual disease1 disease2 1015 disease healthy 1016 disease healthy 1017 disease healthy 1018 disease healthy 1019 healthy healthy 1020 healthy disease 1021 healthy disease 1022 healthy disease <p>You can get the reads and sequence targets with:</p> <pre><code>wget wget https://ngs-longreads-training.s3.eu-central-1.amazonaws.com/project2.tar.gz\ntar -xvf project2.tar.gz\nrm project2.tar.gz\n</code></pre> <p>Note</p> <p>Download the data file package in your shared working directory, i.e. : <code>/group_work/&lt;group name&gt;</code>. Only one group member has to do this.</p> <p>It has the following directory structure:</p> <pre><code>project2\n\u251c\u2500\u2500 reads\n\u2502   \u251c\u2500\u2500 1015.fastq.gz\n\u2502   \u251c\u2500\u2500 1016.fastq.gz\n\u2502   \u251c\u2500\u2500 1017.fastq.gz\n\u2502   \u251c\u2500\u2500 1018.fastq.gz\n\u2502   \u251c\u2500\u2500 1019.fastq.gz\n\u2502   \u251c\u2500\u2500 1020.fastq.gz\n\u2502   \u251c\u2500\u2500 1021.fastq.gz\n\u2502   \u2514\u2500\u2500 1022.fastq.gz\n\u251c\u2500\u2500 reference\n\u2502   \u251c\u2500\u2500 Homo_sapiens.GRCh38.dna.primary_assembly.chrX.chr4.fa\n\u2502   \u2514\u2500\u2500 Homo_sapiens.GRCh38.dna.primary_assembly.chrX.chr4.fa.fai\n\u2514\u2500\u2500 targets\n    \u2514\u2500\u2500 targets.bed\n\n3 directories, 11 files\n</code></pre> <p>The targets in gene1 and gene2 are described in <code>targets/targets.bed</code>. The columns in these <code>.bed</code> files describe the chromosome, start, end, and describe the motifs. To reduce computational load, the reference contains only chromosome 4 and X of the hg38 human reference genome. </p>"},{"location":"course_material/group_work/project2/#tasks-questions","title":"Tasks &amp; questions","text":"<p>Activate the conda environment</p> <p>The tools you will be needed for these exercises are in the conda environment <code>lr-tools</code>. Every time you open a new terminal, activate it with:</p> <pre><code>conda activate lr-tools\n</code></pre> <ul> <li>Load the bed files into IGV and navigate to the regions they annotate.<ul> <li>In which genes are the targets?</li> <li>What kind of diseases are associated with these genes?</li> </ul> </li> <li>Perform a quality control with <code>NanoPlot</code>.<ul> <li>How is the read quality? These are circular concensus sequences (ccs). Is this quality expected?</li> <li>How is the read length?</li> </ul> </li> <li>Align the reads to <code>reference/Homo_sapiens.GRCh38.dna.primary_assembly.chrX.chr4.fa</code> with <code>minimap2</code>. For the option <code>-x</code> you can use <code>asm20</code>. Generate separate alignment files for each individual. Check out some of the bam files in IGV. How does that look? </li> </ul> <p>Alternatively use <code>pbmm2</code></p> <p>Pacific Biosciences has developed a wrapper for <code>minimap2</code> that contains settings specific for PacBio reads, named <code>pbmm2</code>. It might slightly improve your alignments. It is installed in the conda environment. Feel free to give it a try if you have time left.</p> <ul> <li>Use <code>trgt</code> to genotype the repeats. Basically, you want to know the expansion size of each repeat in each sample. Based on this, you can figure out which sample has abnormal expansions in which repeat. To run <code>trgt</code> read the manual. After the alignment, all required input files should be there. </li> <li>To visualize the output, use samtools to sort and index the bam file with the reads spanning the repeats (this is also explained in the manual - no need to run <code>bcftools</code>).</li> <li>Run <code>trvz</code> to visualize the output. The allele plot should suffice. The visualization will give you a nice overview of the repeat expansions in the samples. Based on the different sizes of the repeat expansions, can you relate the repeat expansions to the disease phenotype?</li> </ul> <p>This tutorial is based on data provided by Pacific Biosciences at https://downloads.pacbcloud.com/public/dataset/RepeatExpansionDisorders_NoAmp/</p>"},{"location":"course_material/group_work/project3/","title":"Project 3","text":""},{"location":"course_material/group_work/project3/#project-3-assembly-and-annotation-of-bacterial-genomes","title":"Project 3: Assembly and annotation of bacterial genomes","text":"<p>You will be working with PacBio sequencing data of eight different bacterial species. Divide the species over the members of the group and generate an assembly and annotation. After that, guess the species. </p> <p>Project aim</p> <p>Generate and evaluate an assembly of a bacterial genome out of PacBio reads. </p> <p>There are eight different species: <code>sample_[1-8].fastq.gz</code> </p> <p>Each species has a fastq file available. You can download all fastq files like this: </p> <pre><code>wget https://ngs-longreads-training.s3.eu-central-1.amazonaws.com/project3.tar.gz\ntar -xvf project3.tar.gz\nrm project3.tar.gz\n</code></pre> <p>Note</p> <p>Download the data file package in your shared working directory, i.e. : <code>/group_work/&lt;group name&gt;</code> or <code>~/&lt;group name&gt;</code>. Only one group member has to do this.</p> <p>This will create a directory <code>project3</code> with the following structure:</p> <pre><code>project3\n|-- sample_1.fastq.gz\n|-- sample_2.fastq.gz\n|-- sample_3.fastq.gz\n|-- sample_4.fastq.gz\n|-- sample_5.fastq.gz\n|-- sample_6.fastq.gz\n|-- sample_7.fastq.gz\n`-- sample_8.fastq.gz\n\n0 directories, 8 files\n</code></pre>"},{"location":"course_material/group_work/project3/#before-you-start","title":"Before you start","text":"<p>You can start this project with dividing the species over the different group members. In principle, each group member will go through all the steps of assembly and annotation:</p> <ol> <li>Quality control with <code>NanoPlot</code></li> <li>Assembly with <code>flye</code></li> <li>Assembly QC with <code>BUSCO</code></li> <li>Annotation with <code>prokka</code></li> </ol>"},{"location":"course_material/group_work/project3/#tasks-and-questions","title":"Tasks and questions","text":"<p>Note</p> <p>You have four cores available. Use them! For most tools you can specificy the number of cores/cpus as an argument. </p> <p>Note</p> <p>All require software can be found in the conda environment <code>assembly</code>. Load it like this:</p> <pre><code>conda activate assembly\n</code></pre> <ul> <li>Perform a quality control with <code>NanoPlot</code>.<ul> <li>How is the read quality? Is this quality expected?</li> <li>How is the read length?</li> </ul> </li> <li>Perform an assembly with <code>flye</code>. <ul> <li>Have a look at the helper first with <code>flye --help</code>. Make sure you pick the correct mode (i.e. <code>--pacbio-??</code>). </li> <li>Check out the output. Where is the assembly? How is the quality? For that, check out <code>assembly_info.txt</code>. </li> <li>What species did you assemble? Choose from this list: <pre><code>Acinetobacter baumannii\nBacillus cereus\nBacillus subtilis\nBurkholderia cepacia\nBurkholderia multivorans\nEnterococcus faecalis\nEscherichia coli\nHelicobacter pylori\nKlebsiella pneumoniae\nListeria monocytogenes\nMethanocorpusculum labreanum\nNeisseria meningitidis\nRhodopseudomonas palustris\nSalmonella enterica\nStaphylococcus aureus\nStreptococcus pyogenes\nThermanaerovibrio acidaminovorans\nTreponema denticola\nVibrio parahaemolyticus\n</code></pre></li> <li>Did flye assemble any plasmid sequences?</li> </ul> </li> <li>Check the completeness with <code>BUSCO</code>. Have a good look at the manual first. You can use automated lineage selecton by specifying <code>--auto-lineage-prok</code>. After you have run <code>BUSCO</code>, you can generate a nice completeness plot with <code>generate_plot.py</code>. You can check its usage with <code>generate_plot.py --help</code>. <ul> <li>How is the completeness? Is this expected?</li> </ul> </li> <li>Perform an annotation with <code>prokka</code>. Again, check the manual first. After the run, have a look at for example the statistics in <code>PROKKA_[date].txt</code>. For a nice table of annotated genes have a look in <code>PROKKA_[date].tsv</code>. </li> <li>Compare the assemblies of the different species. Are assembly qualities similar? Can you think of reasons why?</li> </ul> <p>This tutorial is based on data provided by Pacific Biosciences at https://downloads.pacbcloud.com/public/dataset/2021-11-Microbial-96plex/</p>"}]}